<html>
<head>
    <title>Reset Password</title>
    <script type="text/javascript" src="http://bitwiseshiftleft.github.io/sjcl/sjcl.js"></script>
    <script src="http://crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/sha256.js"></script>
    <style media="screen" type="text/css">
        #parent {
            display: table;
            width: 100%;
        }

        #form_login {
            display: table-cell;
            text-align: center;
            vertical-align: middle;
            horiz-align: center;
        }
    </style>
</head>
<body>
<div style="text-align: center;" id="parent">
    <form id="form_login" method="POST" action="updatePassword">
        <div>
            new password
        </div>
        <div>
            <input type="password" id="password" name="password">
        </div>
        <div>
            <input type="hidden" id="token" name="token" value="">
        </div>
        <div>
            <input type="hidden" id="email" name="email" value="">
        </div>

        <div>
            <input type="submit" value="Reset password">
        </div>
    </form>
</div>

<script>
    var password = document.getElementById("password").value;
    var email = getUrlVars()['email'];
    var token = getUrlVars()['token'];
    document.getElementById("token").value = (token);
    document.getElementById("email").value = (email);
    function getUrlVars() {
        var vars = [], hash;
        var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
        for (var i = 0; i < hashes.length; i++) {
            hash = hashes[i].split('=');
            vars.push(hash[0]);
            vars[hash[0]] = hash[1];
        }
        return vars;
    }
</script>

<!--<script>-->
    <!--function hashPassword() {-->
        <!--//encrypt password-->
        <!--var password = document.getElementById("password").value;-->
        <!--var email = getUrlVars()['email'];-->
        <!--var solt = sjcl.codec.base64.toBits(email);-->
        <!--var hash = sjcl.hash.sha256.hash(password)-->
        <!--var encrypted = sjcl.encrypt(password, email);-->
        <!--var json = JSON.parse(encrypted);-->
        <!--var encryptedPassword = json['iv'];-->
        <!--document.getElementById("password").value = (encryptedPassword);-->

        <!--//add token to response-->
        <!--var token = getUrlVars()['token']-->
        <!--document.getElementById("token").value = (token);-->
        <!--function getUrlVars() {-->
            <!--var vars = [], hash;-->
            <!--var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');-->
            <!--for (var i = 0; i < hashes.length; i++) {-->
                <!--hash = hashes[i].split('=');-->
                <!--vars.push(hash[0]);-->
                <!--vars[hash[0]] = hash[1];-->
            <!--}-->
            <!--return vars;-->
        <!--}-->
    <!--};-->
<!--</script>-->


</body>
</html>
